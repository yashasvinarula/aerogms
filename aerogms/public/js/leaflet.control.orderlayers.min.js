/*! leaflet.control.orderlayers 26-09-2013 */
L.Control.OrderLayers=L.Control.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,title:"Administrador de Capas"},initialize:function(a,b,c){L.setOptions(this,c),this._layers={},this._lastZIndex=0,this._handlingClick=!1;for(var d in a)this._addLayer(a[d],d);for(d in b)this._addLayer(b[d],d,!0)},onAdd:function(a){return this._initLayout(),this._update(),a.on("layeradd",this._onLayerChange,this).on("layerremove",this._onLayerChange,this).on("changeorder",this._onLayerChange,this),this._container},onRemove:function(a){a.off("layeradd",this._onLayerChange).off("layerremove",this._onLayerChange).off("changeorder",this._onLayerChange)},addBaseLayer:function(a,b){return this._addLayer(a,b),this._update(),this},addOverlay:function(a,b){return this._addLayer(a,b,!0),this._update(),this},removeLayer:function(a){var b=L.stamp(a);return delete this._layers[b],this._update(),this},_initLayout:function(){var a="leaflet-control-layers",b=this._container=L.DomUtil.create("div",a);b.setAttribute("aria-haspopup",!0),L.Browser.touch?L.DomEvent.on(b,"click",L.DomEvent.stopPropagation):(L.DomEvent.disableClickPropagation(b),L.DomEvent.on(b,"mousewheel",L.DomEvent.stopPropagation));var c=this._form=L.DomUtil.create("form",a+"-list");if(this.options.collapsed){L.Browser.android||L.DomEvent.on(b,"mouseover",this._expand,this).on(b,"mouseout",this._collapse,this);var d=this._layersLink=L.DomUtil.create("a",a+"-toggle",b);d.href="#",d.title="Layers",L.Browser.touch?L.DomEvent.on(d,"click",L.DomEvent.stop).on(d,"click",this._expand,this):L.DomEvent.on(d,"focus",this._expand,this),this._map.on("click",this._collapse,this)}else this._expand();if(this.options.title){var e=L.DomUtil.create("h3",a+"-title");e.innerHTML=this.options.title,c.appendChild(e)}this._baseLayersList=L.DomUtil.create("div",a+"-base",c),this._separator=L.DomUtil.create("div",a+"-separator",c),this._overlaysList=L.DomUtil.create("div",a+"-overlays",c),b.appendChild(c)},_addLayer:function(a,b,c){var d=L.stamp(a);this._layers[d]={layer:a,name:b,overlay:c},this.options.autoZIndex&&a.setZIndex&&(this._lastZIndex++,a.setZIndex(this._lastZIndex))},_update:function(){if(this._container){this._baseLayersList.innerHTML="",this._overlaysList.innerHTML="";var a,b,c=!1,d=!1,e=[];for(a in this._layers)b=this._layers[a],b.overlay?b.layer.options.zIndex&&(e[b.layer.options.zIndex]=b):this._addItem(b),d=d||b.overlay,c=c||!b.overlay;for(a=0;a<e.length;a++)e[a]&&this._addItem(e[a]);L.DomUtil.create("div","clearfix",this._baseLayersList),L.DomUtil.create("div","clearfix",this._overlaysList),this._separator.style.display=d&&c?"":"none"}},_onLayerChange:function(a){var b=this._layers[L.stamp(a.layer)];if(b){this._handlingClick||this._update();var c=b.overlay?"layeradd"===a.type?"overlayadd":"overlayremove":"layeradd"===a.type?"baselayerchange":null;c&&this._map.fire(c,b)}},_createRadioElement:function(a,b){var c='<input type="radio" class="leaflet-control-layers-selector" name="'+a+'"';b&&(c+=' checked="checked"'),c+="/>";var d=document.createElement("div");return d.innerHTML=c,d.firstChild},_addItem:function(a){var b,c=L.DomUtil.create("div","leaflet-row"),d=L.DomUtil.create("label",""),e=this._map.hasLayer(a.layer);a.overlay?(b=L.DomUtil.create("input"),b.type="checkbox",b.className="leaflet-control-layers-selector",b.defaultChecked=e):b=this._createRadioElement("leaflet-base-layers",e),b.layerId=L.stamp(a.layer),L.DomEvent.on(b,"click",this._onInputClick,this);var f=document.createElement("span");f.innerHTML=" "+a.name;var g=L.DomUtil.create("div","leaflet-input");g.appendChild(b),c.appendChild(g),g=L.DomUtil.create("div","leaflet-name"),g.appendChild(d),c.appendChild(g),d.appendChild(f);var h;return a.overlay?(g=L.DomUtil.create("div","leaflet-up"),L.DomEvent.on(g,"click",this._onUpClick,this),g.layerId=b.layerId,c.appendChild(g),g=L.DomUtil.create("div","leaflet-down"),g.layerId=b.layerId,L.DomEvent.on(g,"click",this._onDownClick,this),c.appendChild(g),h=this._overlaysList):h=this._baseLayersList,h.appendChild(c),d},_onInputClick:function(){var a,b,c,d=this._form.getElementsByTagName("input"),e=d.length;for(this._handlingClick=!0,a=0;e>a;a++)b=d[a],c=this._layers[b.layerId],b.checked&&!this._map.hasLayer(c.layer)?this._map.addLayer(c.layer):!b.checked&&this._map.hasLayer(c.layer)&&this._map.removeLayer(c.layer);this._handlingClick=!1},_onUpClick:function(a){var b=a.currentTarget.layerId,c=this._form.getElementsByTagName("input"),d=this._layers[b];if(d.overlay){for(var e=null,f=0;f<c.length;f++){var g=this._layers[c[f].layerId];if(g.overlay&&d.layer.options.zIndex-1===g.layer.options.zIndex){e=g;break}}var h=d.layer.options.zIndex-1;e&&(d.layer.setZIndex(h),e.layer.setZIndex(h+1),this._map.fire("changeorder",d,this))}},_onDownClick:function(a){var b=a.currentTarget.layerId,c=this._form.getElementsByTagName("input"),d=this._layers[b];if(d.overlay){for(var e=null,f=0;f<c.length;f++){var g=this._layers[c[f].layerId];if(g.overlay&&d.layer.options.zIndex+1===g.layer.options.zIndex){e=g;break}}var h=d.layer.options.zIndex+1;e&&(d.layer.setZIndex(h),e.layer.setZIndex(h-1),this._map.fire("changeorder",d,this))}},_expand:function(){L.DomUtil.addClass(this._container,"leaflet-control-layers-expanded")},_collapse:function(){this._container.className=this._container.className.replace(" leaflet-control-layers-expanded","")},hide:function(){this._container.style.display="none"},show:function(){this._container.style.display=""}}),L.control.orderlayers=function(a,b,c){return new L.Control.OrderLayers(a,b,c)};